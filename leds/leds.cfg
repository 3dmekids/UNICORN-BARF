# ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„
# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘           UNICORN-BARF â€” LED FX SYSTEM (2025)        â•‘
# â•‘    DRAMATIC â€¢ FLASHING â€¢ BREATHING â€¢ ALERT MODES     â•‘
# â•‘    For Voron 2.4 â€¢ Case Lights on PD15 (PWM)          â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„


# ============================================================
# CASE LIGHT PIN (PWM on PD15)
# ============================================================
[output_pin caselight]
pin: PD15
pwm: true
cycle_time: 0.01
value: 0.20      # safe idle default


# ============================================================
# LED_IDLE â€” Soft Unicorn Idle Glow
# Low, warm, gentle.
# ============================================================
[gcode_macro LED_IDLE]
description: Soft idle glow (20%)
gcode:
    SET_PIN PIN=caselight VALUE=0.20


# ============================================================
# LED_HEATING â€” Warm breathing effect
# (cycles between 25% â†’ 60% â†’ 25%)
# ============================================================
[gcode_macro LED_HEATING]
description: Breathing warm-up effect
gcode:
    SET_PIN PIN=caselight VALUE=0.25
    G4 P400
    SET_PIN PIN=caselight VALUE=0.60
    G4 P400
    SET_PIN PIN=caselight VALUE=0.25


# ============================================================
# LED_PRINTING â€” Maximum bright
# Full power neutral white work light.
# ============================================================
[gcode_macro LED_PRINTING]
description: Full-bright print mode
gcode:
    SET_PIN PIN=caselight VALUE=1.00


# ============================================================
# LED_ERROR â€” Unicorn-Alertâ„¢ RED STROBE
# Flash OFF/ON in dramatic intense 120ms bursts.
# ============================================================
[gcode_macro LED_ERROR]
description: Red alert strobe (dramatic)
gcode:
    {% for i in range(12) %}
        SET_PIN PIN=caselight VALUE=1.00
        G4 P120
        SET_PIN PIN=caselight VALUE=0.00
        G4 P120
    {% endfor %}
    SET_PIN PIN=caselight VALUE=0.30     # settle into warning mode


# ============================================================
# LED_FLASH â€” Fast white strobe (used during MOVE or TEST)
# ============================================================
[gcode_macro LED_FLASH]
description: High-speed white strobe
gcode:
    {% for i in range(6) %}
        SET_PIN PIN=caselight VALUE=1.00
        G4 P80
        SET_PIN PIN=caselight VALUE=0.10
        G4 P80
    {% endfor %}
    SET_PIN PIN=caselight VALUE=0.50


# ============================================================
# LED_OFF â€” Manual off override
# ============================================================
[gcode_macro LED_OFF]
gcode:
    SET_PIN PIN=caselight VALUE=0.0


# ============================================================
# LED_TEST â€” Play ALL effects for demonstration
# Perfect to show off Unicorn-Barf LED FX!
# ============================================================
[gcode_macro LED_TEST]
description: Runs Heating â†’ Printing â†’ Error Strobe â†’ Idle
gcode:
    M117 LED Showcase...

    # Idle warm
    LED_IDLE
    G4 P800

    # Heating breathe
    LED_HEATING
    G4 P1200

    # Full bright
    LED_PRINTING
    G4 P1000

    # ERROR STROBE
    LED_ERROR
    G4 P1600

    # Back to idle
    LED_IDLE
    M117 LED Showcase Done.
