# ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„
# â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
# â•‘      UNICORN-BARF â€” HARDWARE CONFIG (350 V2.4)       â•‘
# â•‘      Steppers â€¢ Extruder â€¢ Bed â€¢ Probe â€¢ Fans        â•‘
# â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„ğŸ¦„



# ==================== X AXIS â€“ SENSORLESS ====================
[stepper_x]
step_pin: PF13
dir_pin: PF12
enable_pin: !PF14
rotation_distance: 40
microsteps: 32
full_steps_per_rotation: 400
endstop_pin: tmc2209_stepper_x:virtual_endstop   # â† SENSORLESS
position_min: 0
position_endstop: 350
position_max: 350
homing_speed: 45
homing_retract_dist: 0
homing_positive_dir: true

[tmc2209 stepper_x]
uart_pin: PC4
diag_pin: ^PG6           # â† Your old X endstop pin is now diag
run_current: 0.8
hold_current: 0.4
sense_resistor: 0.110
stealthchop_threshold: 0
driver_SGTHRS: 90        # â† Start here (80â€“110 typical for LDO 48mm)

# ==================== Y AXIS â€“ SENSORLESS ====================
[stepper_y]
step_pin: PG0
dir_pin: PG1
enable_pin: !PF15
rotation_distance: 40
microsteps: 32
full_steps_per_rotation: 400
endstop_pin: tmc2209_stepper_y:virtual_endstop   # â† SENSORLESS
position_min: 0
position_endstop: 350
position_max: 350
homing_speed: 45
homing_retract_dist: 0
homing_positive_dir: true

[tmc2209 stepper_y]
uart_pin: PD11
diag_pin: ^PG9           # â† Your old Y endstop pin is now diag
run_current: 0.8
hold_current: 0.4
sense_resistor: 0.110
stealthchop_threshold: 0
driver_SGTHRS: 92        # â† Start here (80â€“110 typical for LDO 48mm)


# ----------------------- Z STEPPERS (TAP + physical endstop) ----------------------
[stepper_z]
step_pin: PF11
dir_pin: PG3
enable_pin: !PG5
rotation_distance: 40
gear_ratio: 80:16
microsteps: 32
endstop_pin: probe:z_virtual_endstop   # TAP is your Z endstop
position_min: -5
position_max: 310

[tmc2209 stepper_z]
uart_pin: PC6
run_current: 0.8
stealthchop_threshold: 999999
# diag_pin deliberately omitted = StallGuard disabled on Z

[stepper_z1]
step_pin: PG4
dir_pin: !PC1
enable_pin: !PA0
rotation_distance: 40
gear_ratio: 80:16
microsteps: 32

[tmc2209 stepper_z1]
uart_pin: PC7
run_current: 0.8
stealthchop_threshold: 999999
# diag_pin deliberately omitted

[stepper_z2]
step_pin: PF9
dir_pin: PF10
enable_pin: !PG2
rotation_distance: 40
gear_ratio: 80:16
microsteps: 32

[tmc2209 stepper_z2]
uart_pin: PF2
run_current: 0.8
stealthchop_threshold: 999999
# diag_pin deliberately omitted

[stepper_z3]
step_pin: PC13
dir_pin: !PF0
enable_pin: !PF1
rotation_distance: 40
gear_ratio: 80:16
microsteps: 32

[tmc2209 stepper_z3]
uart_pin: PE4
run_current: 0.8
stealthchop_threshold: 999999
# diag_pin deliberately omitted


# ----------------------- EXTRUDER -----------------------
[extruder]
step_pin: PE2
dir_pin: PE3
enable_pin: !PD4
rotation_distance: 22.915050432687357945
gear_ratio: 50:10
microsteps: 32
filament_diameter: 1.75
nozzle_diameter: 0.4
sensor_type: ATC Semitec 104NT-4-R025H42G
sensor_pin: PF4
heater_pin: PA2
min_temp: 10
max_temp: 270
min_extrude_temp: 170
pressure_advance: 0.046
max_extrude_cross_section: 5.0

control: pid
pid_Kp: 29.211
pid_Ki: 3.043
pid_Kd: 70.106


# ------------------------ BED --------------------------
[heater_bed]
heater_pin: PA1
sensor_type: ATC Semitec 104NT-4-R025H42G
sensor_pin: PF3
min_temp: 0
max_temp: 120
max_power: 1.0

control: pid
pid_kp: 61.808
pid_ki: 2.040
pid_kd: 468.196



#####################################################################
#   Fan Control  
#####################################################################

# Part Cooling Fan - CNC_FAN0
[fan]
pin: PA8
kick_start_time: 0.5
off_below: 0.10

# Hotend Heatsink Fan - CNC_FAN1
[heater_fan hotend_fan]
pin: PE5
max_power: 1.0
kick_start_time: 0.5
heater: extruder
heater_temp: 50.0

# Electronics Bay Fan - CNC_FAN2
[controller_fan electronics_fan]
pin: PD12
kick_start_time: 0.5
heater: heater_bed
fan_speed: 0.5

# Exhaust / Nevermore - CNC_FAN3
[heater_fan exhaust_fan]
pin: PD13
max_power: 1.0
kick_start_time: 5.0
heater: heater_bed
heater_temp: 50     # adjust to your liking
fan_speed: 1.0




[include leveling.cfg]

